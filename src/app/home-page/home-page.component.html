<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://cdn.staticfile.org/twitter-bootstrap/3.3.7/css/bootstrap.min.css">
    <script src="https://cdn.staticfile.org/jquery/2.1.1/jquery.min.js"></script>
    <script src="https://cdn.staticfile.org/twitter-bootstrap/3.3.7/js/bootstrap.min.js"></script>
  </head>

  <body>
      <!--. Form area -->
      <div style="background-color: rgb(218, 218, 218);">
        <h3 style="font-weight: 500;">Entertainment Event Ticket Search</h3>
        <div>
          <p style="display: inline;">Keyword<span style="color:red;">* </span></p>
          <form class="example-form" style="display: inline;">
            <!-- Initial display part -->
            <input type="text" class="form-control"
              *ngIf="keywordInvalid == false"
              placeholder="Enter Artist, Team or Event Name (eg. Lakers)"
              aria-label="Number"
              matInput
              [formControl]="keywordControl"
              [matAutocomplete]="auto"
              style="display: inline; width: 300px"
              (blur)="checkForm()"
              autofocus>

              <!-- When input keyword is invalid, display this part -->
              <input type="text"
              *ngIf="keywordInvalid == true"
              placeholder="Enter Artist, Team or Event Name (eg. Lakers)"
              aria-label="Number"
              matInput
              [formControl]="keywordControl"
              [matAutocomplete]="auto"
              style="display: inline; width: 300px; border: 3px solid red;"
              autofocus>

              <!-- Error message -->
              <div *ngIf="keywordInvalid == true" style="color: red;">Please enter a keyword</div>

              <!-- Autocomplete -->
              <mat-autocomplete #auto="matAutocomplete">
                <mat-option *ngFor="let option of options" [value]="option">
                  {{option}}
                </mat-option>
              </mat-autocomplete>
          </form>
        </div>
        <br>

        <div ngbDropdown style="display: inline;">
          <p style="display: inline;">Category</p>
          <select name="" id="category" class="form-control" style="width: 150px; display: inline;" data-first-option="true" [(ngModel)]="formInfo.category">
        　　<option value="" class="">All</option>
            <option value="Music">Music</option>
            <option value="Sports">Sports</option>
            <option value="ArtsTheatre">Arts & Theatre</option>
            <option value="Films">Films</option>
            <option value="Miscellaneous">Miscellaneous</option>
          </select>
        </div>
        <br>

        <div ngbDropdown style="display: inline;">
          <p style="display: inline;">Distance</p>
          <input type="number" class="form-control" [(ngModel)]="formInfo.distance" placeholder="10" style="display: inline; width: 100px">
          <select id="category" class="form-control" style="width: 100px; display: inline;" data-first-option="true" [(ngModel)]="formInfo.distanceUnit">
        　　<option value="">Miles</option>
            <option value="km">Kilometers</option>
          </select>   
        </div>
        <br>

        <div>
          <p style="display: inline;">From<span style="color:red;">* </span></p>
          <div style="display: inline;">
          <label class="radio-inline">
            <input type="radio" class="radio" name="optionsRadiosinline" id="optionsRadios3" [(ngModel)]="formInfo.from" value="Here"> Current location
          </label>
          <br>
          <label class="radio-inline">
            <input type="radio" class="radio" name="optionsRadiosinline" id="optionsRadios4" [(ngModel)]="formInfo.from" value="Other"> Other. Please specify
          </label>
          <br>
          <input type="text" *ngIf="formInfo.from == 'Here'" class="form-control" [(ngModel)]="formInfo.fromLocation" style="display: inline; width: 300px" disabled>
          <input type="text" *ngIf="formInfo.from == 'Other' && locationInvalid == false" class="form-control" [(ngModel)]="formInfo.fromLocation" (blur)="checkForm()" style="display: inline; width: 300px" autofocus>
          <input type="text" *ngIf="formInfo.from == 'Other' && locationInvalid == true" class="form-control" [(ngModel)]="formInfo.fromLocation" (blur)="checkForm()" style="display: inline; width: 300px; border: 3px solid red;" autofocus>
          <div *ngIf="formInfo.from == 'Other' && locationInvalid == true" style="color: red;">Please enter a location</div>
        </div>
      </div>
        
        <div>
          <button type="button" *ngIf="getCurrentLocation == false" class="btn btn-primary btn-sm" (click)="doSubmit()" disabled>
            <span class="glyphicon glyphicon-search"></span> Search
          </button>
          <button type="button" *ngIf="getCurrentLocation == true" class="btn btn-primary btn-sm" (click)="doSubmit()">
            <span class="glyphicon glyphicon-search"></span> Search
          </button>
          <button type="button" class="btn btn-default btn-sm" (click)="clearForm()">
            <span class="glyphicon glyphicon-search"></span> Clear
          </button>
        </div>
      </div>
      
      <!-- Seat map modal -->
      <div class="modal-dialog" *ngIf="showModal == true">
        <div class="modal-content">
          <div class="modal-header">Seat Map</div>
          <div class="modal-body">
            <img>
          </div>
          <div class="modal-footer"><a href="#" (click)="closeModal()">Close</a></div>
        </div>
      </div>
      
      <!-- Clear Favorite button -->
      <button type="button" class="btn btn-default btn-sm" (click)="clearFavorite()">
        <span class="glyphicon glyphicon-search"></span> Clear Favorite
      </button>

      <!-- Result/Favorite tab -->
      <ul ngbNav #nav="ngbNav" [(activeId)]="ResultsFavorites" class="nav nav-pills">
        <li [ngbNavItem]="1">
          <a ngbNavLink>Results</a>
        </li>
        <li [ngbNavItem]="2">
          <a ngbNavLink (click)="getFavorite()">Favorites</a>
        </li>
      </ul>

      <!-- Progress bar -->
      <div *ngIf="showProgressBarSearchingEvents == true">
        <p><ngb-progressbar type="info" [value]="progress" [striped]="true"></ngb-progressbar></p>
      </div>

      <div>
        <!-- Favorite -->
        <div *ngIf="ResultsFavorites == 2 && showFavorite == true">
          <hr>
          <button type="button" class="btn btn-default" (click)="goToDetails()">
            Details<span class="material-icons">chevron_right</span>
          </button>
          <table class="table table-hover">
            <thead>
              <tr>
                <th>#</th>
                <th>Date</th>
                <th>Event</th>
                <th>Category</th>
                <th>Venue Info</th>
                <th>Favorite</th>
              </tr>
          </thead>
          <tbody *ngFor="let item of favoriteEventsContentForFrontend; let i = index">
            <tr>
              <td>{{ i+1 }}</td>  <!-- Index starts from 1 -->
              <td>{{ item.dates.start.localDate }}</td>
              <td>
                <a href="#" ngbTooltip={{item.name}} (click)="getDetailsFavorite(i)">
                  {{ item.name }}
                </a>
              </td>
              <td>
                {{ item.Category }}
              </td>
              <td>{{ item._embedded.venues[0].name }}</td>
              <td>
                <a href="#" (click)="setFavorite(i, false)">
                  <span class="material-icons">delete</span>                    
                </a>
              </td>
            </tr>
          </tbody>
          </table>
        </div>

        <!-- Results -->
        <div *ngIf="showEvents == true">
          <div *ngIf="ResultsFavorites == 1">
            <!-- No records -->
            <div class="alert alert-warning" *ngIf="noEvents == true">
              No records.
            </div>

            <!-- Events table -->
            <div *ngIf="noEvents == false">
              <hr>
              <button type="button" class="btn btn-default" *ngIf="currentEventsContentForDetails == undefined" (click)="goToDetails()" disabled>
                Details<span class="material-icons">chevron_right</span>
              </button>
              <button type="button" class="btn btn-default" *ngIf="currentEventsContentForDetails != undefined" (click)="goToDetails()">
                Details<span class="material-icons">chevron_right</span>
              </button>
              <table class="table table-hover">
                <thead>
                  <tr>
                    <th>#</th>
                    <th>Date</th>
                    <th>Event</th>
                    <th>Category</th>
                    <th>Venue Info</th>
                    <th>Favorite</th>
                  </tr>
              </thead>
              <tbody *ngFor="let item of eventsContent; let i = index">
                <tr>
                  <td>{{ i+1 }}</td>  <!-- Index starts from 1 -->
                  <td>{{ item.dates.start.localDate }}</td>
                  <td>
                    <a href="#" ngbTooltip={{item.name}} (click)="getDetails(i)">
                      {{ item.name }}
                    </a>
                  </td>
                  <td>
                    {{ item.Category }}
                  </td>
                  <td>{{ item._embedded.venues[0].name }}</td>
                  <td>
                    <a href="#" (click)="setFavorite(i, false)">
                      <span class="glyphicon glyphicon-star-empty" style="color: black;"></span>
                    </a>
                  </td>
                </tr>
              </tbody>
              </table>
            </div>
          </div>
        </div>
      </div>
      <!-- Details -->
      <div>
        <!-- progress bar -->
        <div *ngIf="showProgressBarLoadingDetails == true">
          <p><ngb-progressbar type="info" [value]="progress" [striped]="true"></ngb-progressbar></p>
        </div>

        <!-- Detail table -->
        <div *ngIf="showDetailsBlock == true">
          <hr>
          <!-- Buttons in detail page -->
          <div>
            <!-- Go back to list button -->
            <button type="button" class="btn btn-default" (click)="goBackToList()">
              <span class="material-icons">chevron_left</span>List
            </button>
            <!-- Twitter button -->
            <a class="twitter-share-button"
              href={{twitterApi}} target="_blank">
              <img src="https://csci571.com/hw/hw8/images/Twitter.png" style="width: 40px; height: 40px;">
            </a>

            <!-- Favorite button -->
            <button type="button" class="btn btn-default">
              <a href="#" (click)="setFavorite(-1, true)">
                <span class="glyphicon glyphicon-star-empty" style="color: black;"></span>
              </a>
            </button>
          </div>

          <h3 align="center" style="font-weight: 500;">{{detailContent.Name}}</h3>

          <!-- Nav bar -->
          <ul ngbNav #nav="ngbNav" [(activeId)]="navChosen" class="nav-tabs justify-content-end">
            <li [ngbNavItem]="1">
              <a ngbNavLink>Event</a>
            </li>
            <li [ngbNavItem]="2">
              <a ngbNavLink>Artist/Team</a>
            </li>
            <li [ngbNavItem]="3">
              <a ngbNavLink>Venue</a>
            </li>
          </ul>

          <!-- Content of each choice in nav bar -->

          <!-- Event tab -->
          <div *ngIf="navChosen == 1">
            <table class="table table-striped">
              <tbody>
                <tr *ngIf="detailContent.ArtistTeam != ''">
                  <td>Artist/Team</td>
                  <td>{{ detailContent.ArtistTeam }}</td>
                </tr>

                <tr *ngIf="detailContent.Venue != ''">
                  <td>Venue</td>
                  <td>{{ detailContent.Venue }}</td>
                </tr>

                <tr *ngIf="detailContent.Time != ''">
                  <td>Time</td>
                  <td>{{ detailContent.Time | date }}</td>
                </tr>

                <tr *ngIf="detailContent.Category != ''">
                  <td>Category</td>
                  <td>{{ detailContent.Category }}</td>
                </tr>

                <tr *ngIf="detailContent.PriceRange != ''">
                  <td>Price Range</td>
                  <td>{{ detailContent.PriceRange }}</td>
                </tr>

                <tr *ngIf="detailContent.TicketStatus != ''">
                  <td>Ticket Status</td>
                  <td>{{ detailContent.TicketStatus }}</td>
                </tr>

                <tr *ngIf="detailContent.BuyTicketAt != ''">
                  <td>Buy Ticket At</td>
                  <td><a href= {{detailContent.BuyTicketAt}} target="_blank">Ticketmaster</a></td>
                </tr>

                <tr *ngIf="detailContent.SeatMap != ''">
                  <td>Seat Map</td>
                  <td><a href="#" (click)="openModal()">View Seat Map Here</a></td>
                </tr>
                
              </tbody>
            </table>
          </div>

          <!-- Artist/Team tab -->
          <div *ngIf="navChosen == 2">
            <div *ngIf="artistContentList?.length == 0">
              <div class="alert alert-warning">
                No records.
              </div>
            </div>
            <div *ngIf="artistContentList?.length > 0">
              <table class="table table-hover" *ngFor="let item of artistContentList; let i = index">
                <thead align="center">
                    {{item.Name}}
                </thead>
              <tbody>
                <tr>
                  <td>Name</td><td>{{item.Name}}</td>
                </tr>
                <tr>
                  <td>Followers</td><td>{{item.Followers | number }}</td>
                </tr>
                <tr>
                  <td>Popularity</td>
                  <td>
                    <div style="position: relative;"><round-progress 
                    [current]="item.Popularity" 
                    [max]="100"
                    [color]="'#48BD28'"
                    [stroke]="5"
                    [radius]="20"
                    ></round-progress>
                    <p style="position: absolute;top: 0%; left:3%; margin-top: 3%;">{{item.Popularity}}</p>
                  </div>
                  </td>
                </tr>
                <tr>
                  <td>Check At</td><td><a href={{item.CheckAt}} target="_blank">Spotify</a></td>
                </tr>
              </tbody>
              </table>
          </div>
          </div>

          <!-- Venue tab -->
          <div *ngIf="navChosen == 3">
            <table class="table table-striped">
              <tbody>
                <tr *ngIf="venueDetailContent.Address != ''">
                  <td>Address</td>
                  <td>{{ venueDetailContent.Address }}</td>
                </tr>
                <tr *ngIf="venueDetailContent.City != ''">
                  <td>City</td>
                  <td>{{ venueDetailContent.City }}</td>
                </tr>
                <tr *ngIf="venueDetailContent.PhoneNumber != ''">
                  <td>Phone Number</td>
                  <td>{{ venueDetailContent.PhoneNumber }}</td>
                </tr>
                <tr *ngIf="venueDetailContent.OpenHours != ''">
                  <td>Open Hours</td>
                  <td>{{ venueDetailContent.OpenHours }}</td>
                </tr>
                <tr *ngIf="venueDetailContent.GeneralRule != ''">
                  <td>General Rule</td>
                  <td>{{ venueDetailContent.GeneralRule }}</td>
                </tr>
                <tr *ngIf="venueDetailContent.ChildRule != ''">
                  <td>Child Rule</td>
                  <td>{{ venueDetailContent.ChildRule }}</td>
                </tr>
              </tbody>
            </table>

            <h3>My Google Maps Demo</h3>
              <agm-map [latitude]="lat" [longitude]="lng" style="height: 300px;">
                <agm-marker [latitude]="lat" [longitude]="lng"></agm-marker>
            </agm-map>
          </div>

        </div>
      </div>

  </body>

</html>
<style>
  .modal {
  display: block;
}

.modal-body:before,
  .modal-body:after {
    display: table;
    content: " ";
}

.modal-header:before,
.modal-header:after {
  display: table;
  content: " ";
}
</style>

